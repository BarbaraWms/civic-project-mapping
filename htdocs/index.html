<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="http://getbootstrap.com/favicon.ico">

    <title>Creative Capital Project Mapping</title>

    <!-- Bootstrap core CSS -->
    <link href="index_files/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="index_files/navbar-static-top.css" rel="stylesheet">

    <!-- Site-specific Navigation -->
    <link rel="stylesheet" type="text/css" href="css/application.css">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="index_files/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <style type="text/css">
      #map-canvas { height: 900px; margin: 0; padding: 0;}

      dt, dd { float: left }
      dt { clear:both }

      .filter-1 { background-color: hsl(87, 64%, 42%); }

    </style>
  </head>

  <body>

    <!-- Static navbar -->
    <nav class="navbar navbar-default navbar-static-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Project Mapping</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="contact.html">Contact</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>



    <div class="container-fluid">

        <div class="row">
            <div class="col-md-12">
                <ul class="nav nav-pills" role="tablist">
                    <li role="presentation" id="all"><a href="#">All <span id="cnt-all" class="badge">0</span></a></li>
                    <li role="presentation" id="capacity-building"><a href="#">Capacity Building <span id="cnt-capacity-building" class="badge">0</span></a></li>
                    <li role="presentation" id="housing"><a href="#">Housing and Physical Development <span class="badge">0</span></a></li>
                    <li role="presentation" id="environmental"><a href="#">Environmental and Public Health <span id="cnt-environmental" class="badge">0</span></a></li>
                    <li role="presentation" id="public-safety"><a href="#">Public Safety & Crime <span class="badge">0</span></a></li>
                    <li role="presentation" id="education"><a href="#">Education <span class="badge">0</span></a></li>
                    <li role="presentation" id="arts-and-culture"><a href="#">Arts and Culture <span id="cnt-arts-and-culture" class="badge">0</span></a></li>
                    <li role="presentation" id="other"><a href="#">Other <span class="badge">0</span></a></li>
                </ul>
            </div>
        </div>


        <div class="row">
            <div class="col-md-3">
                <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                </div>
            </div>
            <div class="col-md-9">
                <div id="map-canvas">
                </div>
            </div>
        </div>
    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
      <script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>
      <script src="index_files/jquery.js"></script>
      <script src="index_files/bootstrap.js"></script>
      <script src="js/tkmap.4.0.0.js"></script>
      <script src="js/projects.js"></script>
      <script src="js/fusiontable.js"></script>
        <script src="js/event.js"></script>

        <script src="js/infobox.js"></script>





      <script type="text/javascript">
          google.maps = google.maps || {};
      (function($,TkMap,Projects,FusionTable){
          /**
           * @classDescription - Default settings for this application
           * @class - Default
           */
          var Default = {
              // City
              city:'Kansas City',
              // DOM ID of where the Google Map is to be rendered
              domid:'map-canvas',
              // Google Fusion Tables SQL-like query string for flu shot location data
              eventquery:"SELECT * FROM 1MfAjP3KeJ8Zh27vzPNXuVmr9pXb4Cqch1bqY4pq9 ORDER BY 'Project description' ",
              // Google Fusion Tables URI
              fturl:'https://www.googleapis.com/fusiontables/v1/query',
              // Google maps API key
              googlemapsapikey:'AIzaSyDQNzkJUiUJBqI_pex-Xe9_1JD4sf2KZS8',

              infoboxoptions:{
                  disableAutoPan: false,
                  maxWidth: 0,
                  pixelOffset: new google.maps.Size(-121, 0),
                  zIndex: null,
                  boxStyle: {
                      background: "url('img/tipbox.gif') no-repeat",
                      opacity: 0.92,
                      width: "240px",
                      height: "240px"
                  },
                  closeBoxMargin: "11px 4px 4px 4px",
                  closeBoxURL: "img/close_x.png",
                  infoBoxClearance: new google.maps.Size(25, 60),
                  visible: false,
                  pane: "floatPane",
                  enableEventPropagation: false
              },
              // Start center latutude of the Google map
              lat:39.0997,
              // Start center longitude of the Google map
              lng:-94.5783,
              // State
              state:'Missouri',
              // Defined style types passed to TkMap
              styles:'grey minlabels',
              // Initial zoom level for the Google map
              zoom:12,
              // Zoom for finding address
              zoomaddress:14
          };

          /*
           * jQuery's 'on document ready' function
           * Run this after the DOM is fully loaded.
           */
          $(function(){




              var Map = new TkMap({
                  domid:Default.domid,
                  init:true,
                  lat:Default.lat,
                  lng:Default.lng,
                  styles:Default.styles,
                  zoom:Default.zoom
              }); // END Map object constructor

              /**
               * The Project application object
               */
              var Proj = new Projects(Default.infoboxoptions);

              /**
               * Put a legend up for the pins in on the right bottom of the screen
               */

              // var LegendDiv = document.createElement('div');
              // Proj.setMapLegend(LegendDiv,Map,Proj,Default);
              // LegendDiv.index = 1;
              // Map.Map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(LegendDiv);

              /**
               * Put the Find Me button up on the upper right hand of the screen
               */

              if(Proj.geolocate)
              {
                  var FindMeDiv = document.createElement('div');
                  Proj.setFindMeControl(FindMeDiv,Map,Proj,Default);
                  FindMeDiv.index = 1;
                  Map.Map.controls[google.maps.ControlPosition.TOP_RIGHT].push(FindMeDiv);
              }

              /**
               * Load the projects data
               */

              // Get the flu shot event data from the Google Fusion Table
              var EventsFT = new FusionTable(Default.fturl,Default.eventquery,Default.googlemapsapikey);
              $.getJSON(EventsFT.url, {
                  dataType: 'jsonp',
                  timeout: 5000
              })
              .done(function (ftdata) {
                          console.dir(ftdata);
                  EventsFT.columns = ftdata.columns;
                  EventsFT.rows = ftdata.rows;
                  Proj.getEvents(EventsFT.columns,EventsFT.rows,Map);
                  // Highlight all today's and upcoming events.
                  Proj.setMarkersByDay('all');
              })
              .fail(function(){
                  alert('Oh, no! We are having trouble getting the information we need from storage.');
              });





          }); // END jQuery on document ready
      })(jQuery,TkMap,Projects,FusionTable);


    </script>
</body></html>
